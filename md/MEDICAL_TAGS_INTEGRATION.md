# ربط التخصصات الطبية مع API

## نظرة عامة
تم تحديث نظام إدارة التخصصات الطبية ليتوافق مع API الخاص بـ `/medical-tags` مع دعم رفع الصور والحقول المطلوبة.

## الملفات المُحدثة

### 1. أنواع البيانات الجديدة
**الملف:** `src/types/specialties.ts`
- `MedicalTag`: نوع البيانات الأساسي للتخصص الطبي
- `CreateMedicalTagRequest`: نوع البيانات لإنشاء تخصص جديد
- `UpdateMedicalTagRequest`: نوع البيانات لتحديث تخصص موجود
- `MedicalTagsResponse`: نوع استجابة API للقائمة
- `MedicalTagResponse`: نوع استجابة API لتخصص واحد

### 2. Hook مخصص للتعامل مع API
**الملف:** `src/hooks/useMedicalTags.ts`
- `useMedicalTags()`: Hook رئيسي لإدارة التخصصات
- `useMedicalTag(id)`: Hook لجلب تخصص واحد
- دعم العمليات: إنشاء، تحديث، حذف، جلب البيانات
- معالجة الأخطاء وعرض الرسائل
- دعم رفع الصور باستخدام FormData

### 3. مكون إضافة/تعديل التخصص المُحدث
**الملف:** `src/components/specialties/AddEditSpecialtyDialog.tsx`
- دعم الحقول الجديدة: `name`, `name_ar`, `description`, `icon`, `is_active`
- واجهة رفع الصور مع معاينة
- التحقق من صحة البيانات (حجم الصورة، طول النص)
- دعم تحديث الصور الموجودة

### 4. مكون قائمة التخصصات المُحدث
**الملف:** `src/components/specialties/SpecialtiesList.tsx`
- عرض الأيقونات والحقول الجديدة
- تحسين التصميم والتخطيط
- دعم حالات التحميل والحذف

### 5. الصفحة الرئيسية المُحدثة
**الملف:** `src/pages/Specialties.tsx`
- استخدام Hook الجديد بدلاً من البيانات الثابتة
- إضافة إحصائيات متقدمة
- معالجة حالات التحميل والأخطاء
- تحسين واجهة المستخدم

## مواصفات API المدعومة

### Endpoint
```
POST /medical-tags
PUT /medical-tags/{id}
GET /medical-tags
DELETE /medical-tags/{id}
```

### الحقول المطلوبة
- `name`: نص، حد أقصى 255 حرف، فريد
- `icon`: ملف صورة، حد أقصى 2048 KB

### الحقول الاختيارية
- `name_ar`: نص عربي، حد أقصى 255 حرف
- `description`: وصف نصي
- `is_active`: قيمة منطقية (افتراضي: true)

## الميزات الجديدة

### 1. رفع الصور
- دعم رفع أيقونات للتخصصات
- معاينة الصور قبل الحفظ
- التحقق من نوع وحجم الملف
- دعم تحديث الصور الموجودة

### 2. الحقول متعددة اللغات
- دعم الاسم بالإنجليزية والعربية
- وصف اختياري للتخصص

### 3. إدارة الحالة
- تفعيل/إلغاء تفعيل التخصصات
- عرض الحالة في القائمة والإحصائيات

### 4. الإحصائيات المتقدمة
- إجمالي التخصصات
- التخصصات النشطة/غير النشطة
- معدل النشاط
- عرض تفصيلي لكل تخصص

### 5. تحسينات واجهة المستخدم
- مؤشرات التحميل
- رسائل الأخطاء والنجاح
- تحديث البيانات تلقائياً
- تصميم متجاوب

## كيفية الاستخدام

### 1. إضافة تخصص جديد
```typescript
const { createMedicalTag } = useMedicalTags();

const newSpecialty = {
  name: "طب القلب",
  name_ar: "Cardiology", 
  description: "تخصص طب القلب والأوعية الدموية",
  icon: imageFile, // File object
  is_active: true
};

createMedicalTag(newSpecialty);
```

### 2. تحديث تخصص موجود
```typescript
const { updateMedicalTag } = useMedicalTags();

updateMedicalTag({
  id: 1,
  data: {
    name: "طب القلب المحدث",
    is_active: false
  }
});
```

### 3. حذف تخصص
```typescript
const { deleteMedicalTag } = useMedicalTags();
deleteMedicalTag(1);
```

## معالجة الأخطاء
- رسائل خطأ واضحة للمستخدم
- التحقق من صحة البيانات قبل الإرسال
- معالجة أخطاء الشبكة والخادم
- إعادة المحاولة التلقائية

## الأمان
- التحقق من نوع الملفات المرفوعة
- حد أقصى لحجم الصور (2MB)
- تنظيف البيانات المدخلة
- استخدام FormData لرفع الملفات بأمان

## الأداء
- استخدام React Query للتخزين المؤقت
- تحديث البيانات بذكاء
- تحميل البيانات عند الحاجة فقط
- معالجة حالات التحميل بكفاءة